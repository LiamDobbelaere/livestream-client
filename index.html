<html>
  <head>
    <title>Livestream</title>
    <link href="//vjs.zencdn.net/7.3.0/video-js.min.css" rel="stylesheet" />
    <script src="//vjs.zencdn.net/7.3.0/video.min.js"></script>
  </head>
  <body>
    <video-js
      id="example-video"
      width="960"
      height="540"
      class="vjs-default-skin"
      controls
    >
    </video-js>
    <script src="videojs-http-streaming.min.js"></script>
    <script>
      var player = videojs("example-video");
      var params = location.search
        .split("?")
        .join(";")
        .split("&")
        .join(";")
        .split(";")
        .filter(e => e.length)
        .reduce((acc, current, index) => {
          acc[current.split("=")[0]] = current.split("=")[1];
          return acc;
        }, {});

      if (!params.v && !params.live) {
        params.live = "digaly";
      }

      if (params.live) {
        console.log("Assuming live");
        player.src({
          src: "https://live.diga.link/hls/" + params.live + ".m3u8",
          type: "application/x-mpegURL"
        });
        player.play();
      } else if (params.v) {
        console.log("Assuming video");
        player.src({
          src: "https://live.diga.link/vod/" + params.v,
          type: "video/x-flv"
        });
        player.play();
      }

      console.log(params);
    </script>
  </body>
</html>
